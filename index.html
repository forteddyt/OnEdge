<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Stay on Edge</title>
    <style>
    	* { padding: 0; margin: 0; border:"1px solid #000000"}
    	canvas { background: #F0F0F0; display: block; margin: 0 auto; border: "5px solid gray";}
    </style>
</head>
<body>
<canvas id="gameCanvas" width="540" height="280" ></canvas>

<script src="player.js"></script>
<script src="meteor.js"></script>
<script src="star.js"></script>
<script src="space.js"></script>
<script src="platform.js"></script>
<script src="game.js"></script>
<script src="score.js"></script>
<script>

var canvas = document.getElementById("gameCanvas");
var ctx = canvas.getContext("2d");
var game = new Game(ctx);

document.addEventListener('click', onClickHandler, false);
document.addEventListener('keydown', onKeyDownHandler, false);
document.addEventListener('keyup', onKeyUpHandler, false);

function onClickHandler(evt) {
	if (game.gameOver) {
		var midWidth = canvas.width/2;
		var midHeight = canvas.height/2;
		var buttonWidth = canvas.width*2/5;
		var buttonHeight = canvas.width/8;

		if (evt.layerX > midWidth - buttonWidth/2 && evt.layerX < midWidth + buttonWidth/2 && 
		evt.layerY > 5 * midHeight / 4 - buttonHeight*2/3 && evt.layerY <5 * midHeight / 4 + buttonHeight/3) {
			restartGame();
		}
	}
}

function onKeyDownHandler(evt) {
	if (game.gameOver) {
		if ((game.Player.rightPressed || game.Player.leftPressed) && game.keyUp) {
			game.keyUp = false;
		}
		if (game.keyUp && 
			(evt.key == "Right" || evt.key == "ArrowRight" || 
			evt.key == "Left" || evt.key == "ArrowLeft" ||
			evt.key == " " || evt.key == "Space")) {
				restartGame();
		}
	}
}

function onKeyUpHandler(evt) {
	if (game.gameOver) {
	    game.keyUp = true;
	}
}

function restartGame() {
	game.restart();
}

const Consts = {
	meteorRadius : 10,
	meteorSpeed : 2, //default fall speed for meteors per frame */
	buttonWidth : canvas.width*2/5,
	buttonHeight : canvas.width/8,
	gameOverWidth : canvas.width*3/4,
	gameOverHeight : canvas.height/4,
};

//animation

</script>

